<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kenji Kondo" />

<meta name="date" content="2019-01-03" />

<title>A Starting Guide for aglm</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">A Starting Guide for aglm</h1>
<h4 class="author"><em>Kenji Kondo</em></h4>
<h4 class="date"><em>2019-01-03</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>not provided yet</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>To install the latest version from <code>github</code> :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;kkondo1981/aglm&quot;</span>)</code></pre></div>
</div>
<div id="quick-start" class="section level2">
<h2>Quick Start</h2>
<p>The purpose of this section is to give users a general understanding of aglm package and its usage.</p>
<div id="load-package" class="section level3">
<h3>Load Package</h3>
<p>First, we need to load aglm package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(aglm)</code></pre></div>
</div>
<div id="handling-predictor-variables" class="section level3">
<h3>Handling Predictor Variables</h3>
<p>Next, we need data for fitting to AGLM. Here, we simply generate random data observations as following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># size of observations</span>
nobs &lt;-<span class="st"> </span><span class="dv">100</span>

<span class="co"># Randomly generate a quantitative explanatory variable</span>
quan_var &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(nobs), <span class="dt">ncol=</span><span class="dv">1</span>)
<span class="kw">colnames</span>(quan_var) &lt;-<span class="st"> &quot;quantitative&quot;</span>

<span class="co"># Randomly generate qalitative a explanatory variable with 4 levels</span>
qual_var &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">paste0</span>(<span class="st">&quot;level_&quot;</span>, <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, nobs, <span class="dt">replace=</span><span class="ot">TRUE</span>)), <span class="dt">ncol=</span><span class="dv">1</span>)
<span class="kw">colnames</span>(qual_var) &lt;-<span class="st"> &quot;qualitative&quot;</span></code></pre></div>
<div id="predvars-objects" class="section level4">
<h4><code>PredVars</code> objects</h4>
<p>In aglm package, predictor variables (or explanatory variables) are represented by an object of class named <code>PredVars</code>. We can create a new PredVars object by calling <code>newPredVars</code> function. Please be noticed that we passed the quantitative variable and the qualitative variable separetely to <code>newPredVars</code> function so that aglm package can understand they are variables of different kinds.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">preds &lt;-<span class="st"> </span><span class="kw">newPredVars</span>(<span class="dt">x=</span>quan_var, <span class="dt">x_UD=</span>qual_var)</code></pre></div>
<p>Note that the abovementioned step can be omitted in practice, because aglm inference functions convert data into a <code>PredVars</code> object automatically if other types of data are given, and users do not need to care about <code>PredVars</code> objects at all. Howver, we continue to explain more about <code>PredVars</code> objects and <code>newPredVars</code> function in this section for better understanding of what aglm package does internally.</p>
</div>
<div id="syntax-sugars" class="section level4">
<h4>Syntax sugars</h4>
<p>In this case, each of the following commented statements is OK and has same meanings as the above code. It might be surprising the third statement with no explicit instructions for distinguish quantitative and qualitative variables works. This is because the <code>PredVars</code> function has a feature to automatically judge which columns of <code>x</code> are quantitative and which are qualitative by classes of their values, so that columns with class “character” or “factor” are treated as qualitative variables and others are treated as quantitative variables. Note that this automatic feature is only used if and only if explicit instructions by <code>x_UD</code> or <code>UD_vars</code> options are not given.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># x_all &lt;- data.frame(quan_var, qual_var); preds &lt;- newPredVars(x=all_vars, UD_vars=2)</span>
<span class="co"># x_all &lt;- data.frame(quan_var, qual_var); preds &lt;- newPredVars(x=all_vars, UD_vars=&quot;qualitative&quot;)</span>
<span class="co"># x_all &lt;- data.frame(quan_var, qual_var); preds &lt;- newPredVars(x=all_vars)</span></code></pre></div>
</div>
<div id="informations-held-by-predvars-objects" class="section level4">
<h4>Informations held by <code>PredVars</code> objects</h4>
<p>The created <code>PredVars</code> object contains not only original data (say, quan_vars and qual_vars), but also some information for telling aglm package how to handle each predictor variable. To understanding that point, let’s see the internal representation of <code>PredVars</code> object with the <code>str</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(preds)
<span class="co">#&gt; Formal class 'PredVars' [package &quot;aglm&quot;] with 2 slots</span>
<span class="co">#&gt;   ..@ vars_info:List of 3</span>
<span class="co">#&gt;   .. ..$ :List of 7</span>
<span class="co">#&gt;   .. .. ..$ idx        : int 1</span>
<span class="co">#&gt;   .. .. ..$ name       : chr &quot;quantitative&quot;</span>
<span class="co">#&gt;   .. .. ..$ type       : chr &quot;O&quot;</span>
<span class="co">#&gt;   .. .. ..$ data_column: int 1</span>
<span class="co">#&gt;   .. .. ..$ mu         : num -0.108</span>
<span class="co">#&gt;   .. .. ..$ sigma      : num 1.03</span>
<span class="co">#&gt;   .. .. ..$ dummy_info :List of 1</span>
<span class="co">#&gt;   .. .. .. ..$ breaks: num [1:21] -Inf -2.16 -1.93 -1.71 -1.49 ...</span>
<span class="co">#&gt;   .. ..$ :List of 5</span>
<span class="co">#&gt;   .. .. ..$ idx        : int 2</span>
<span class="co">#&gt;   .. .. ..$ name       : chr &quot;qualitative&quot;</span>
<span class="co">#&gt;   .. .. ..$ type       : chr &quot;U&quot;</span>
<span class="co">#&gt;   .. .. ..$ data_column: int 2</span>
<span class="co">#&gt;   .. .. ..$ dummy_info :List of 2</span>
<span class="co">#&gt;   .. .. .. ..$ levels   : chr [1:4] &quot;level_1&quot; &quot;level_2&quot; &quot;level_3&quot; &quot;level_4&quot;</span>
<span class="co">#&gt;   .. .. .. ..$ drop_last: logi TRUE</span>
<span class="co">#&gt;   .. ..$ :List of 5</span>
<span class="co">#&gt;   .. .. ..$ idx     : num 3</span>
<span class="co">#&gt;   .. .. ..$ name    : chr &quot;quantitative_x_qualitative&quot;</span>
<span class="co">#&gt;   .. .. ..$ type    : chr &quot;I&quot;</span>
<span class="co">#&gt;   .. .. ..$ var_idx1: int 1</span>
<span class="co">#&gt;   .. .. ..$ var_idx2: int 2</span>
<span class="co">#&gt;   ..@ data     :'data.frame':    100 obs. of  2 variables:</span>
<span class="co">#&gt;   .. ..$ quantitative: num [1:100] 0.335 0.357 -0.571 0.845 1.657 ...</span>
<span class="co">#&gt;   .. ..$ qualitative : Factor w/ 4 levels &quot;level_1&quot;,&quot;level_2&quot;,..: 4 1 1 3 4 4 3 3 2 1 ...</span></code></pre></div>
<p>First of all, we can see a <code>PredVars</code> object has two slots (or members) named <code>vars_info</code> and <code>data</code>, and may notice that the slot named <code>data</code> is just a data.frame object which contains all the values of predictor variables given when it is created. Next, please be noticed that the slot named <code>vars_info</code> consists of 3 lists of different lengths, each of which contains some meta-informations of one predictor variable as following:</p>
<ul>
<li>The first list with length 7 (idx=1) contains information of <code>quan_var</code>.</li>
<li>The second list with length 5 (idx=2) contains information of <code>qual_var</code>.</li>
<li>The third list with length 5 (idx=3) contains information of an automatically added variable which represents a interaction term <code>quan_var * qual_var</code>. We can instruct not to add interaction terms by using <code>append_interactions_vars=FALSE</code> when calling <code>newPredVars</code>.</li>
</ul>
<p>These informations are used by aglm package for creating its internal design matrix representation of predictor variables. See <a href="#appendix-0-how-predictor-variables-are-treated-by-aglm">Appendix 0: How predictor variables are treated by aglm</a> for more details about the topic.</p>
</div>
</div>
<div id="fitting-aglm" class="section level3">
<h3>Fitting AGLM</h3>
<p>In this section, we show how to fit the AGLM with aglm package, using the following simple nonlinear response variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resp_var &lt;-<span class="st"> </span><span class="kw">abs</span>(quan_var) <span class="op">**</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<p>We can use the <code>aglm</code> function to fit the model as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted &lt;-<span class="st"> </span><span class="kw">aglm</span>(<span class="dt">x=</span>preds, <span class="dt">y=</span>resp_var, <span class="dt">lambda=</span><span class="fl">0.1</span>)</code></pre></div>
<p>The <code>lambda</code> option specifies the coefficient of regularization term in the loss function, and <code>aglm</code> function examined multiple different values if <code>lambda</code> is not explicitly given. Note that because the <code>aglm</code> function currently uses <code>glmnet</code> as its backend, and almost all the parameters for <code>glmnet</code> function also work when they are passed to <code>aglm</code> function, and meanings of such parameters are basically as same as <code>glmnet</code>.</p>
</div>
</div>
<div id="non-gaussian-models" class="section level2">
<h2>non-Gaussian Models</h2>
<p>not provided yet</p>
</div>
<div id="appendix-0-how-predictor-variables-are-treated-by-aglm" class="section level2">
<h2>Appendix 0: How predictor variables are treated by aglm</h2>
<p>not provided yet</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
